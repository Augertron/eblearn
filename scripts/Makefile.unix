ifndef (prj)
prj := all
endif

INCLUDE_INSTALL=/usr/include/eblearn/
LIB_INSTALL=/usr/lib/

all: libs

release:
	@echo __________________________________________________________________
	@echo
	@echo "Compiling ${prj} project(s) in release mode..."
	@echo "Use 'make release prj=idxgui' for example to compile a specific project."
	@echo __________________________________________________________________
	cd build/Release && cmake -DCMAKE_BUILD_TYPE=Release ../.. && make ${prj} && cd ../..

libs:
	@echo __________________________________________________________________
	@echo
	@echo "Compiling libraries in release mode..."
	@echo __________________________________________________________________
	cd build/Release && cmake -DCMAKE_BUILD_TYPE=Release ../.. && make idx eblearn idxgui eblearngui && cd ../..
	
tools:
	@echo __________________________________________________________________
	@echo
	@echo "Compiling tools in release mode..."
	@echo __________________________________________________________________
	cd build/Release && cmake -DCMAKE_BUILD_TYPE=Release ../.. && make dscompiler dsdisplay dssplit meta_trainer meta_plot && cd ../..
	
# demo:
# 	@echo __________________________________________________________________
# 	@echo
# 	@echo "Compiling demos in release mode..."
# 	@echo __________________________________________________________________
# 	cd build/Demos && cmake -DCMAKE_BUILD_TYPE=Release ../../demos/ && make && cd ../..

# test:
# 	@echo __________________________________________________________________
# 	@echo
# 	@echo "Compiling tester in release mode..."
# 	@echo __________________________________________________________________
# 	cd build/Release && cmake -DCMAKE_BUILD_TYPE=Release ../.. && make tester && cd ../..

debug:
	@echo __________________________________________________________________
	@echo
	@echo "Compiling ${prj} project(s) in debug mode..."
	@echo "Use 'make debug prj=idxgui' for example to compile a specific project."
	@echo __________________________________________________________________
	cd build/Debug && cmake -DCMAKE_BUILD_TYPE=Debug ../.. && make ${prj} && cd ../..

clean:
	rm -rf build/Debug/*
	rm -rf build/Release/*
	rm -rf bin/*

install:
	mkdir -p $(INCLUDE_INSTALL)
	cp -n libidx/include/* $(INCLUDE_INSTALL)
	cp -n libeblearn/include/* $(INCLUDE_INSTALL)
	cp -n libidxgui/include/* $(INCLUDE_INSTALL)
	cp -n libeblearngui/include/* $(INCLUDE_INSTALL)
	cp -n libeblearntools/include/* $(INCLUDE_INSTALL)
	cp bin/libidx.so $(LIB_INSTALL)
	cp bin/libeblearn.so $(LIB_INSTALL)
	cp bin/libeblearntools.so $(LIB_INSTALL)
	cp bin/libidxgui.so $(LIB_INSTALL)
	cp bin/libeblearngui.so $(LIB_INSTALL)
