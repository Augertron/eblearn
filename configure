#!/bin/sh

# 1: build makefiles
sh scripts/configure_build.sh unix

# 2: configure IPP, MNIST & CO

USE_IPP=IPPOFF
IPP_DIR=
LIBS=""
LIBS_IPP="-lippiemerged -lippimerged -lippcore -lippsmerged"
MNIST=""

# echo "1. Use proprietary Intel Integrated Primitives (IPP) libraries? (y/N)"
# echo -n "\t"
#   read ans
#   case $ans in
#     [yY]) echo "Ok, what is your IPP directory? (Example: /opt/intel/ipp)"
#     echo -n "\t"
#     USE_IPP=USE_IPP
#     LIBS="$LIBS $LIBS_IPP"
#     read IPP_DIR
#     test -d $IPP_DIR
#     if [ $? -eq 1 ] 
#       then echo -n "Error, not a valid path: "
#            echo $IPP_DIR
#            exit 1
#       fi
#     echo -n "\tOk, using IPP from directory: "
#     echo $IPP_DIR
#     ;;
#     *) echo "\tNot using IPP libraries."
#   esac

mkdir bin 2> /dev/null

echo "* (optional) Enter your MNIST dataset directory (absolute path)"
echo "  (MNIST can be found here: http://yann.lecun.com/exdb/mnist/)"
echo "  or press ENTER to ignore this:"
/bin/echo -en "\t"
  read ans
  case $ans in
    "") echo "Not using mnist."
    ;;
    *) test -d $ans
    if [ $? -eq 1 ] 
      then echo -n "Error, not a valid path: "
           echo $ans
           exit 1
      fi
    /bin/echo -en "Ok, using MNIST from directory: "
    /bin/echo $ans
    /bin/echo -e "\n-mnist $ans" >> run.init
  esac

#ouputing arguments to main() for runtime

echo "Configuration done. Now run make or make debug"

# TODO: offer to dl + unpack mnist
# mkdir -p mnist
# wget http://yann.lecun.com/exdb/mnist/train-labels-idx1-ubyte.gz
# wget http://yann.lecun.com/exdb/mnist/t10k-labels-idx1-ubyte.gz
# wget http://yann.lecun.com/exdb/mnist/t10k-images-idx3-ubyte.gz
# wget http://yann.lecun.com/exdb/mnist/train-images-idx3-ubyte.gz
# cd mnist && gunzip *
