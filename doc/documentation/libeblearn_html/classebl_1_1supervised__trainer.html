<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>libeblearn: ebl::supervised_trainer&lt; Tdata, Tlabel &gt; Class Template Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><b>ebl</b>::<a class="el" href="classebl_1_1supervised__trainer.html">supervised_trainer</a>
  </div>
</div>
<div class="contents">
<h1>ebl::supervised_trainer&lt; Tdata, Tlabel &gt; Class Template Reference</h1><!-- doxytag: class="ebl::supervised_trainer" --><code>#include &lt;<a class="el" href="EblTrainer_8h-source.html">EblTrainer.h</a>&gt;</code>
<p>

<p>
<a href="classebl_1_1supervised__trainer-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="23ff24fa1a83363343bc501378e041dd"></a><!-- doxytag: member="ebl::supervised_trainer::supervised_trainer" ref="23ff24fa1a83363343bc501378e041dd" args="(fc_ebm2&lt; state_idx, int, state_idx &gt; &amp;m, parameter &amp;p, ostream &amp;cout=std::cout)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>supervised_trainer</b> (<a class="el" href="classebl_1_1fc__ebm2.html">fc_ebm2</a>&lt; <a class="el" href="classebl_1_1state__idx.html">state_idx</a>, int, <a class="el" href="classebl_1_1state__idx.html">state_idx</a> &gt; &amp;m, <a class="el" href="classebl_1_1parameter.html">parameter</a> &amp;p, ostream &amp;cout=std::cout)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ebdd83d813f7329aed14ded5de227b8b"></a><!-- doxytag: member="ebl::supervised_trainer::set_display" ref="ebdd83d813f7329aed14ded5de227b8b" args="(unsigned int nh, unsigned int nw, unsigned int h0=0, unsigned int w0=0, double zoom=1.0, int wid=-1, const char *title=NULL)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>set_display</b> (unsigned int nh, unsigned int nw, unsigned int h0=0, unsigned int w0=0, double zoom=1.0, int wid=-1, const char *title=NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classebl_1_1supervised__trainer.html#27266cc7b64334255dc646b33ea351c7">run</a> (<a class="el" href="classebl_1_1state__idx.html">state_idx</a> &amp;input, infer_param &amp;infp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classebl_1_1supervised__trainer.html#a088a41796b911a76680306719a44102">test_sample</a> (<a class="el" href="classebl_1_1state__idx.html">state_idx</a> &amp;input, int label, int &amp;answer, infer_param &amp;infp)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">Idx&lt; double &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classebl_1_1supervised__trainer.html#34eace3f645e823c01017d1d123e5ff0">learn_sample</a> (<a class="el" href="classebl_1_1state__idx.html">state_idx</a> &amp;input, int label, <a class="el" href="classebl_1_1gd__param.html">gd_param</a> &amp;arg)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classebl_1_1supervised__trainer.html#6814cc5466befb4a9793adaf04654bcc">test</a> (LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;ds, <a class="el" href="classebl_1_1classifier__meter.html">classifier_meter</a> &amp;log, infer_param &amp;infp, bool display=false)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classebl_1_1supervised__trainer.html#e4d4897c67df38d8868aef355032b4fe">train</a> (LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;ds, <a class="el" href="classebl_1_1classifier__meter.html">classifier_meter</a> &amp;log, <a class="el" href="classebl_1_1gd__param.html">gd_param</a> &amp;args, int niter)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="9f728de27be40cf2ac43dea5678c222a"></a><!-- doxytag: member="ebl::supervised_trainer::compute_diaghessian" ref="9f728de27be40cf2ac43dea5678c222a" args="(LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;ds, intg niter, double mu)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classebl_1_1supervised__trainer.html#9f728de27be40cf2ac43dea5678c222a">compute_diaghessian</a> (LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;ds, intg niter, double mu)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">compute hessian <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classebl_1_1supervised__trainer.html#e6ab4937140ca984465e117272666527">resize_input</a> (LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;ds)</td></tr>

<tr><td colspan="2"><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a675115a903aced5f7f8de4f3d091f13"></a><!-- doxytag: member="ebl::supervised_trainer::machine" ref="a675115a903aced5f7f8de4f3d091f13" args="" -->
<a class="el" href="classebl_1_1fc__ebm2.html">fc_ebm2</a>&lt; <a class="el" href="classebl_1_1state__idx.html">state_idx</a>, int, <br>
<a class="el" href="classebl_1_1state__idx.html">state_idx</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>machine</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6fd6a06e42352d91523cc74c434f36a2"></a><!-- doxytag: member="ebl::supervised_trainer::param" ref="6fd6a06e42352d91523cc74c434f36a2" args="" -->
<a class="el" href="classebl_1_1parameter.html">parameter</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>param</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="dad522c7df4f620aa2dc8cb542ab99e4"></a><!-- doxytag: member="ebl::supervised_trainer::input" ref="dad522c7df4f620aa2dc8cb542ab99e4" args="" -->
<a class="el" href="classebl_1_1state__idx.html">state_idx</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>input</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="af099822e2240dc701e691003706330a"></a><!-- doxytag: member="ebl::supervised_trainer::energy" ref="af099822e2240dc701e691003706330a" args="" -->
<a class="el" href="classebl_1_1state__idx.html">state_idx</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>energy</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0744413c1c78efe367b220a9399693c9"></a><!-- doxytag: member="ebl::supervised_trainer::label" ref="0744413c1c78efe367b220a9399693c9" args="" -->
Idx&lt; Tlabel &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>label</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="d5b600420d70f140b02be9a8a97512bf"></a><!-- doxytag: member="ebl::supervised_trainer::age" ref="d5b600420d70f140b02be9a8a97512bf" args="" -->
intg&nbsp;</td><td class="memItemRight" valign="bottom"><b>age</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="3f293a3598c36dc5c534296425f17f4d"></a><!-- doxytag: member="ebl::supervised_trainer::cout" ref="3f293a3598c36dc5c534296425f17f4d" args="" -->
ostream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><b>cout</b></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
<h3>template&lt;class Tdata, class Tlabel&gt;<br>
 class ebl::supervised_trainer&lt; Tdata, Tlabel &gt;</h3>

Generic Trainer Supervised Trainer <hr><h2>Member Function Documentation</h2>
<a class="anchor" name="27266cc7b64334255dc646b33ea351c7"></a><!-- doxytag: member="ebl::supervised_trainer::run" ref="27266cc7b64334255dc646b33ea351c7" args="(state_idx &amp;input, infer_param &amp;infp)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Tdata, class Tlabel&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classebl_1_1supervised__trainer.html">ebl::supervised_trainer</a>&lt; Tdata, Tlabel &gt;::run           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classebl_1_1state__idx.html">state_idx</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">infer_param &amp;&nbsp;</td>
          <td class="paramname"> <em>infp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
take an input and a vector of possible labels (each of which is a vector, hence &lt;label-set&gt; is a matrix) and return the index of the label that minimizes the energy fill up the vector &lt;energies&gt; with the energy produced by each possible label. The first dimension of &lt;label-set&gt; must be equal to the dimension of &lt;energies&gt;. 
</div>
</div><p>
<a class="anchor" name="a088a41796b911a76680306719a44102"></a><!-- doxytag: member="ebl::supervised_trainer::test_sample" ref="a088a41796b911a76680306719a44102" args="(state_idx &amp;input, int label, int &amp;answer, infer_param &amp;infp)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Tdata, class Tlabel&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classebl_1_1supervised__trainer.html">ebl::supervised_trainer</a>&lt; Tdata, Tlabel &gt;::test_sample           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classebl_1_1state__idx.html">state_idx</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&nbsp;</td>
          <td class="paramname"> <em>answer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">infer_param &amp;&nbsp;</td>
          <td class="paramname"> <em>infp</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Test a single sample and its label &lt;label&gt; (an integer). Returns true if the sample was correctly classified, false otherwise. 
</div>
</div><p>
<a class="anchor" name="34eace3f645e823c01017d1d123e5ff0"></a><!-- doxytag: member="ebl::supervised_trainer::learn_sample" ref="34eace3f645e823c01017d1d123e5ff0" args="(state_idx &amp;input, int label, gd_param &amp;arg)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Tdata, class Tlabel&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">Idx&lt; double &gt; <a class="el" href="classebl_1_1supervised__trainer.html">ebl::supervised_trainer</a>&lt; Tdata, Tlabel &gt;::learn_sample           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classebl_1_1state__idx.html">state_idx</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classebl_1_1gd__param.html">gd_param</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>arg</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
perform a learning update on one sample. &lt;sample&gt; is the input sample, &lt;label&gt; is the desired category (an integer), &lt;label-set&gt; is a matrix where the i-th row is the desired output for the i-th category, and &lt;update-args&gt; is a list of arguments for the <a class="el" href="classebl_1_1parameter.html">parameter</a> update method (e.g. learning rate and weight decay). 
</div>
</div><p>
<a class="anchor" name="6814cc5466befb4a9793adaf04654bcc"></a><!-- doxytag: member="ebl::supervised_trainer::test" ref="6814cc5466befb4a9793adaf04654bcc" args="(LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;ds, classifier_meter &amp;log, infer_param &amp;infp, bool display=false)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Tdata, class Tlabel&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classebl_1_1supervised__trainer.html">ebl::supervised_trainer</a>&lt; Tdata, Tlabel &gt;::test           </td>
          <td>(</td>
          <td class="paramtype">LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classebl_1_1classifier__meter.html">classifier_meter</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">infer_param &amp;&nbsp;</td>
          <td class="paramname"> <em>infp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>display</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Measure the average energy and classification error rate on a dataset. returns a list with average loss and proportion of errors 
</div>
</div><p>
<a class="anchor" name="e4d4897c67df38d8868aef355032b4fe"></a><!-- doxytag: member="ebl::supervised_trainer::train" ref="e4d4897c67df38d8868aef355032b4fe" args="(LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;ds, classifier_meter &amp;log, gd_param &amp;args, int niter)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Tdata, class Tlabel&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classebl_1_1supervised__trainer.html">ebl::supervised_trainer</a>&lt; Tdata, Tlabel &gt;::train           </td>
          <td>(</td>
          <td class="paramtype">LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classebl_1_1classifier__meter.html">classifier_meter</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>log</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classebl_1_1gd__param.html">gd_param</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>args</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>niter</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
train for &lt;niter&gt; sweeps over the training set. &lt;samples&gt; contains the inputs samples, and &lt;labels&gt; the corresponding desired categories &lt;labels&gt;. return the average energy computed on-the-fly. &lt;update-args&gt; is a list of arguments for the <a class="el" href="classebl_1_1parameter.html">parameter</a> update method (e.g. learning rate and weight decay). 
</div>
</div><p>
<a class="anchor" name="e6ab4937140ca984465e117272666527"></a><!-- doxytag: member="ebl::supervised_trainer::resize_input" ref="e6ab4937140ca984465e117272666527" args="(LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;ds)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class Tdata, class Tlabel&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="classebl_1_1supervised__trainer.html">ebl::supervised_trainer</a>&lt; Tdata, Tlabel &gt;::resize_input           </td>
          <td>(</td>
          <td class="paramtype">LabeledDataSource&lt; Tdata, Tlabel &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>ds</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Resize &lt;input&gt; based on the datasource. If &lt;input&gt; is not allocated, allocate it. TODO: If order or dimensions have changed, reallocate. 
</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>/media/e/eblearn-trunk/libeblearn/include/<a class="el" href="EblTrainer_8h-source.html">EblTrainer.h</a><li>/media/e/eblearn-trunk/libeblearn/include/<a class="el" href="EblTrainer_8hpp-source.html">EblTrainer.hpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Mar 30 18:15:26 2009 for libeblearn by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
